
实现在检测到~~u盘~~目录存在后将~~u盘~~目录中的文件静默复制到指定目录中  
复制时保留源目录结构~~就是不仅把ppt搞出来还按原方式分文件夹~~  
如有bitlocker锁，则等待解锁后复制~~就是u盘有密码也可以~~  
经测试可正确运行于Windows10（1903,1909,2004），其他系统未知了~~其实是懒得试~~<br>  

## 重中之重<br> 

+ <font size=4> **GUI版运行需要安装 .NET 4.7.2！！！**</font>
  若未安装，请运行：“NDP472-KB4054530-x86-x64-AllOS-ENU.exe”安装<br>

+ <font size=4> **5.0的setting.txt和其他版本的不兼容,不可互换！！！**</font>

+ 由于使用了Qt，可能会导致兼容性问题
  

## v 5.0.0更新内容

+ 增加主程序运行日志
+ 更改自动建立文件夹选项为可选
  
## 使用说明

+ <font size=4> **编辑配置文件**</font>

 1. 编辑“setup.txt”完成配置
 2. 运行“start无提示.vbs”或“start有提示.vbs”运行程序，等待u盘插入（切不可直接运行copy.exe!）
 3. u盘插入后，程序自动复制文件
 4. 待u盘拔出后，检查复制出来的文件，若有需要，打开“log.txt”查看日志并进行下一步操作
   
+ <font size=4> **使用GUI配置工具**</font>
  
1. 运行静默拷文件.exe，完成配置后，点击保存并启动按钮（高级选项 is useful，但不了解建议不要勾选）
2. u盘插入后，程序自动复制文件
3. 待u盘拔出后，检查复制出来的文件，若有需要，打开“log.txt”查看日志并进行下一步操作
   
+ <font size=4> **“setup.txt”的填写及修改说明**</font>
  
  + 请填写在提示字符的下一行（已留空，直接填在空行就好）
  + 留空代表不使用该选项
  + 删除时请留出空行，即各提示字符间必须留有一行空行，多了少了都不行
  + 本蒟蒻已预先填写好一些内容，均可修改。但(不建议修改）的内容不建议修改及删除（大神请随意）
   
+ <font size=4> **“start无提示.vbs”和“start有提示.vbs”**</font>
  无提示则复制完成后不会有任何反应，有提示则复制完成后会有一“您的资料已被盗！”弹窗弹出

## setup.txt”配置选项
<table border="1">
  <tr>
    <th>配置名</th>
    <th>说明</th>
    <th>填写说明</th>
    <th>样例</th>
  </tr>
  <tr>
  <td>文件源模式</td>
  <td>按何种方式检测文件源</td>
  <td>0:盘符，1:磁盘名称</td>
  <td>0</td>
  </tr>
  <tr>
    <td>文件源</td>
    <td>即从哪个目录复制，写卷标或绝对路径或磁盘名称</td>
    <td>若留空，即自动检测盘符</td>
    <td>C: D: E: F:\hhh\hhh EFI</td>
  </tr>
  <tr>
    <td>文件名</td>
    <td>即复制什么文件，可以使用“*”</td>
    <td>可以填写多个，用空格隔开<br>若留空，即复制源目录下所有文件</td>
    <td>*.ppt *.pptx</td>
  </tr>
  <tr>
    <td>目标目录</td>
    <td>即复制到哪里，记得写路径</td>
    <td>需为文件夹<br>若留空，则自动在程序目录下建立一个名为files的文件夹</td>
    <td>C:\Users\32154\Desktop</td>
  </tr>
  <tr>
    <td>文件最大限制</td>
    <td>即只复制大小不大于此限制的文件</td>
    <td>单位是字节<br>1MB=1024KB<br>1KB=1024字节</td>
    <td>0</td>
  </tr>
  <tr>
    <td>文件最小限制</td>
    <td>即只复制大小不小于此限制的文件</td>
    <td>单位是字节<br>1MB=1024KB<br>1KB=1024字节</td>
    <td>0</td>
  </tr>
  <tr>
    <td>最长的文件存在时间</td>
    <td></td>
    <td>日期或数字</td>
    <td>20180203意为只复制2018年2月3日及以后复制进文件源的文件；<br>10意为只复制10天以内复制进文件源的文件</td>
  </tr>
  <tr>
    <td>最短的文件存在时间</td>
    <td></td>
    <td></td>
    <td>如填20180203，意为只复制2018年2月3日及以前复制进文件源的文件，如填10，意为只复制10天以前复制进文件源的文件</td>
  </tr>
  <tr>
    <td>最大的最后访问日期</td>
    <td></td>
    <td>日期</td>
    <td>20180203意为只复制2018年2月3日及以后使用过的文件</td>
  </tr>
  <tr>
    <td>最小的最后访问日期</td>
    <td></td>
    <td>日期</td>
    <td>20180203意为只复制2018年2月3日及以后未使用的文件</td>
  </tr>
  <tr>
    <td>失败副本的重试次数</td>
    <td>若复制失败，重新尝试复制该文件的次数</td>
    <td>数字</td>
    <td>0</td>
  </tr>
  <tr>
    <td>两次重试间的等待时间</td>
    <td>若复制失败，下一次尝试前的等待时间</td>
    <td>数字</td>
    <td>0</td>
  </tr>
  <tr>
    <td>仅复制源目录树的前 n 层</td>
    <td>只复制文件源前n个文件夹中的文件</td>
    <td>数字</td>
    <td>5</td>
  </tr>
  <tr>
    <td>使用 n 个线程进行多线程复制</td>
    <td>同时复制多个文件</td>
    <td>n越大复制速度可能越高，但正常使用受到的影响也越大</td>
    <td>1</td>
  </tr>
  <tr>
    <td>日志文件</td>
    <td>不可修改</td>
    <td></td>
    <td>log.txt</td>
  </tr>
  <tr>
    <td>等待时间</td>
    <td>检测u盘插入与再次检测，检测到u盘插入与开始复制文件，检测bitlocker解锁与再次检测之间的时间间隔</td>
    <td>越大资源消耗越少</td>
    <td>500</td>
  </tr>
  <tr>
    <td>程序包间间隔</td>
    <td>释放低速线路上的带宽</td>
    <td>单位是毫秒(1s=1000s)复制速度会有所降低</td>
    <td>200</td>
  </tr>
  <tr>
    <td>自动建立文件夹</td>
    <td>自动在目标目录下新建文件夹并将文件存入其中</td>
    <td>1或2(1 代表建立， 2 代表不建立)</td>
    <td>1</td>
  </tr>
  <tr>
  <td>复制前的等待时间</td>
  <td>检测到磁盘可访问与开始复制之间的时间</td>
  <td>数字，单位为秒</td>
  <td>120</td>
  </tr>
</table>  

## 运行截图
<center><img src="https://s1.ax1x.com/2020/07/22/UHSWuV.png" style="zoom:80%" /></center>
